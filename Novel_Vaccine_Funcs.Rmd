---
title: "Novel_Vaccine_Funcs"
author: "K. Anderson"
date: "2025-01-27"
output: html_document
---

Created from organization of "NovelVaccineFuns_B.R"

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Input ranges

```{r input range}
SumOfPostitives = c(0:8)
SumOfInfected = c(0:8)
SumOfVaccinated = c(0:8)
```

## Vaccination Probabilities

### Functions for vaccination probability based on surrounding vaccinated individuals (V+)
```{r}
#Prob. of vaccinating if confident (A+) but hold novelty (B-) bias
topnov = 0.99 - 0.5/(1+ exp(-13*((SumOfVaccinated/8)-0.5))) #A+ Prob of vacc Nov
#Prob. of vaccinating if confident (A+) but hold conformity (B+) bias
topconfm = 0.5+ 0.49/(1+ exp(-13*((SumOfVaccinated/8)-0.5))) #A+ Prob of vacc Conform
#Prob. of vaccinating if confident (A+) but hold neutral (B0) bias
neut_conf_vacc = 0.05*(SumOfVaccinated) + 0.55 #(12/04/24)

#Prob. of vaccinating if hesitant (A-) but hold novelty (B-) bias
botnov = 0.5 - 0.5/(1+ exp(-13*((SumOfVaccinated/8)-0.5))) #A- Prob of vacc Nov
#Prob. of vaccinating if hesitant (A-) but hold conformity (B+) bias
botconfm = 0.002+ 0.49/(1+ exp(-13*((SumOfVaccinated/8)-0.5)))#A- Prob of vacc conform
#Prob. of vaccinating if hesitant (A-) but hold neutral (B0) bias
neut_hes_vacc = 0.05*(SumOfVaccinated) + 0.05

```

### Vaccination by Vaccination Plots
```{r, echo=FALSE}
plot(SumOfVaccinated, topnov, type = "o", col = "red",lwd=2, ylim = 0:1, xlab="Number of Surrounding Vaccinated (V+)", ylab = "Vaccination Probability")#A+
lines(SumOfVaccinated, botnov, type = "o", col = "red", lty=2, lwd=2)
lines(SumOfVaccinated, neut_conf_vacc, type = "o", lwd=2)

lines(SumOfVaccinated,topconfm , type = "o", col = "blue", lwd=2)
lines(SumOfVaccinated, botconfm, type = "o", col = "blue", lty=2, lwd=2)
lines(SumOfVaccinated, neut_hes_vacc, type = "o", lty=2, lwd=2)
```

### Functions for vaccination probability based on surrounding infected individuals (D+)
```{r}
#Probability of Vaccinating if confident
pm3 =  (1.01 - exp(-0.35* SumOfInfected))/2 + 0.5
#Probability of Vaccinating if hesitant
pn3 = (1.2 - exp(-0.35* SumOfInfected))/2 + 0.1
```

### Vaccination by Infected Plots
```{r, echo=FALSE}
plot(SumOfInfected, pm3, type = "o", col = "black", lwd=2, ylim = 0:1, xlab="Number of Surrounding Infected (D+)", ylab = "Vaccination Probability")#A+
lines(SumOfInfected, pn3, type = "o", col = "green", lwd=2)#A-
legend("topleft", c("A+", "A-"), fill = c("black", "green"))

```

## Attitude Transition Probabilities

### Functions for attitude transition probability based on surrounding confident individuals (A+)
#### Confident
```{r}
#Confident novelty bias
px3 = 0.002 + (0.99/(1 + exp(-13*((SumOfPostitives/8)-0.5)))) 
#Confident neutral bias
neut_conf_transb = -0.075*(SumOfPostitives) + 0.8 #Change in code
#Confident conformist bias
pz3 = 0.99 - 0.99/(1+ exp(-13*((SumOfPostitives/8)-0.5)))

```
### Transition if Confident Plot
```{r}
plot(SumOfPostitives, px3, type= "o", col = "red",lwd=2, ylim = 0:1,xlab = "Number of Surrounding Confident (A+)", ylab = "Prob. of Att. Trans. to Hesit. (A+ --> A-)")#novelty
lines(SumOfVaccinated, neut_conf_transb, type = "o", lwd=2)#neutral 8/14 poly
lines(SumOfPostitives, pz3, type = "o", col = "blue", lwd=2)#conform
legend("top", c("Conform", "Neutral", "Novelty"), fill = c("blue","black", "red"))
```

#### Hesitant
```{r}
#Hesitant-Novelty bias
pz3 = 0.99 - 0.99/(1+ exp(-13*((SumOfPostitives/8)-0.5)))
#Hesitant-Neutral Bias
neut_hes_transb = 0.075*(SumOfPostitives) + 0.2 #Change in code
#Hesitant conformist bias
pr3 = 0.002 + 0.99/(1+ exp(-13*((SumOfPostitives/8)-0.5))) 

# neut_hes_trans2 = 0.003125*(SumOfPostitives)^2 + 0.0375*SumOfPostitives + 0.3
# neut_conf_trans = -0.0003125*(SumOfVaccinated)^2 - 0.12125*SumOfVaccinated + 0.99
# neut_conf_trans2 = 0.1125*(SumOfVaccinated) + 0.05 #Change in main code
```

### Transition if Hesitant Plot
```{r}

plot(SumOfPostitives, pz3, type= "o", col = "red",lwd=2, ylim = 0:1, xlab = "Number of Surrounding Confident (A+)", ylab = "Prob. of Att. Trans to Conf. (A- --> A+)")
lines(SumOfPostitives, neut_hes_transb, type = "o", lwd=2)#neutral 8/14 poly
lines(SumOfPostitives, pr3, type = "o", col = "blue", lwd=2)
legend("top", c("Conform", "Neutral", "Novelty"), fill = c("blue","black", "red"))

```


#### Influencer Effects

```{r}
prob_of_change <- seq(0,1, 0.1)
kk = 0.14

#if agent is hesitant and only follows confident -> increase prob of change by some factor determined by kk

#Currently: yy = prob_of_change + kk;  yy <- (1+kk)*(prob_of_change)
# New: yy = kk + (1-kk)*x^n OR
yh1 = kk + (1-kk)*prob_of_change #(Change in code; no need for 0 condition)

# if hesitant agent only follows hesitant --> reduce prob of change by some factor of kk

#Currently: yy <- prob_of_change-kk; yy <- prob_of_change*(1-kk)
#New:
yh2 = prob_of_change- (kk*prob_of_change) #(*** Essentially the same. Also no need for 0 condition)


#if hesitant agent follows both confident and hesitant ()
  #-> reduced prob of change but not as much as following only hesitant (incorporates backfire effect)

#Currently: yy <- prob_of_change -kk/2; (1-kk/2)*(prob_of_change)
#New:
yh3 = (1-kk/2)*prob_of_change #(*** Essentially the same. Also no need for 0 condition - Keep)

  # OR Prob of change increases, but not as much as if only following confident
yh3b = kk/2 + (1-kk/2)*prob_of_change

plot(prob_of_change, yh1, type = "o", lwd=2, ylim = 0:1, xlab = "Attitude Transition Probability if Hesitant (A- --> A+)", ylab = "Probability after Influencer Effects")
lines(prob_of_change, yh2, type = "o", lwd=2, col = "blue")
lines(prob_of_change, yh3, type = "o", lwd=2, col = "red")
lines(prob_of_change, yh3b, lty = 2, lwd=2, col = "red")
title("If Agent is Hesitant...")
legend("top", c("Following Confident", "Following Hesitant", "Following Both", "Following Both_b"), lty = c(1,1,1,2), col = c("black","blue", "red", "red"))



#If confident and only following confident --> reduce probability of change by kk

#Currently: yy <- prob_of_change - kk; yy <- prob_of_change*(1-kk)
#Update:
yc1 = prob_of_change- (kk*prob_of_change) #(*** Essentially the same. Also no need for 0 condition)

#if confident and only following hesitant -> increase prob of change

#Currently: yy <- prob_of_change + kk; yy <- prob_of_change*(1+kk)
#Update:
yc2 = kk + (1-kk)*prob_of_change #(Change in code; no need for 0 condition)

# if confident and following both confident and hesitant 
    #--> reduce probability of change but not as much only following confident
   
#Currently: yy <- prob_of_change - kk/2; yy = (1-kk/2)*(prob_of_change)
#Update:
yc3 = (1-kk/2)*prob_of_change #(*** Essentially the same. Also no need for 0 condition -- Keep)

    #OR Prob of change increases, but not as much as if only following hesitant
yc3b = kk/2 + (1-kk/2)*prob_of_change


plot(prob_of_change, yc1, type = "o", lwd=2, ylim = 0:1, xlab = "Attitude Transition Probability if Confident (A+ --> A-)", ylab = "Probability after Influencer Effects")
lines(prob_of_change, yc2, type = "o", lwd=2, col = "blue")
lines(prob_of_change, yc3, type = "o", lwd=2, col = "red")
lines(prob_of_change, yc3b, lty = 2, lwd=2, col = "red")
title("If Agent is Confident...")
legend("top", c("Following Confident", "Following Hesitant", "Following Both", "Following Both_b"), lty = c(1,1,1,2), col = c("black","blue", "red", "red"))


```
